
@{
    ViewBag.Title = "scheduledIndex";
    Layout = "~/Views/Shared/_LayoutPage1.cshtml";
}



<div class="breadcrumb flat">
    <a href="#" class="mx-1"style="cursor: default">
        <em class="fa fa-home"></em>
    </a>

    @Html.Partial("~/Views/Shared/_submenu.cshtml")
</div>
<style>
    table {
        /*  table-layout: fixed;
        word-wrap: break-word;*/
    }

    .bg {
        color: #11145b !important;
        font-weight:600;
    }
</style>
<div class="panel panel-default">

    <br />
    @if (Convert.ToBoolean((Session["RoleName"].ToString()) == "SuperAdmin"))
    {<span id="excBound"></span><br /><br />
        <span id="excBound1"></span>

    }


    <table id="employeeTable" class="table table-striped table-bordered" style="width:100%">
        <thead>
            <tr>
                @if (Convert.ToBoolean((Session["RoleName"].ToString()) == "SuperAdmin"))
                {
                    <td><input type="checkbox" id="checkAll" onclick="checkAll()" /></td>
                }
                <th>Names</th>
                <th>Email</th>
                <th>Mobile Number</th>
                <th>College Name</th>
                <th>Department</th>
                <th>Location</th>
                <th>Year</th>
                @if (Convert.ToBoolean((Session["RoleName"].ToString()) == "SuperAdmin"))
                {
                    <th>Resume</th>
                }
                <th></th>
            </tr>
        </thead>
    </table>


    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.0.1/css/buttons.dataTables.min.css">

    @section scripts{
        <script src="~/Scripts/jquery.js"></script>
        <script src="~/Scripts/jquerydatatable.js"></script>
        <script src="~/Scripts/dataTables.buttons.min.js"></script>
        <script src="~/Scripts/jszip.min.js"></script>
        <script src="~/Scripts/pdfmake.min.js"></script>
        <script src="~/Scripts/vfs_fonts.js"></script>
        <script src="~/Scripts/buttons.html5.min.js"></script>
        <script src="~/Scripts/buttons.print.min.js"></script>
        <script href="https://cdn.datatables.net/buttons/2.2.2/js/buttons.colVis.min.js"></script>





        <script>

                var Popup, dataTable;
                $(document).ready(function () {
                    debugger;
                    var theStatusV = $("#theStatus").val();
                    var empNameV = $("#Employee").val();
                    var locaV = $("#Location").val();
                    var departV = $("#Department").val();
                    var DataBody = {
                        Status: theStatusV,
                        name: empNameV,
                        location: locaV,
                        department: departV
                    };
                    dataTable = $("#employeeTable").DataTable({
                        "scrollX": true,


                        "ajax": {
                            "url": "/Home/getintervieweddetails",
                            "type": "GET",
                            "datatype": "json",

                        },

                        "dom": 'Bfrtip',
                        "lengthMenu": [[100, 200, 250, 500], [100, 200, 250, 500]],
                        "buttons": [

                            {
                                "extend": 'excelHtml5',
                                "text": "Export To Excel",
                                "exportOptions": {
                                    "exportOptions": [0, ':visible'],
                                    "columns": [0, 1, 2, 3, 4, 5, 6, 7],
                                    "filename": 'Candidate Report'
                                }
                            },

                        ],

                        "columns": [
                            {
                                "data": "employeeid", "render": function (data) {

                                    return ' @if (Convert.ToBoolean((Session["RoleName"].ToString()) == "SuperAdmin")){<td><input type="checkbox" style="margin-left:7px;" class="checkBoxClass" id="checkbox' + data + '" name="datarows" value=' + data + ' onclick="getCheckedData()" /></td>}'
                                }
                            },
                            { "data": "name" },
                            { "data": "workemail" },
                            { "data": "Mobilenumber" },
                            { "data": "collegeName" },
                            { "data": "department" },
                            { "data": "location" },
                            { "data": "year" },
                            {
                                "data": "url",
                                "render": function (data, type, row) {

                                    return ' @if (Convert.ToBoolean((Session["RoleName"].ToString()) == "SuperAdmin")){<a id="lnk" class="btn btn-info" role="button" href=' + data + ' target="_blank">ViewResume </a>}'


                                }
                            },

                            @*{
                                "data": "employeeid", "render": function (data) {
                                    return " @if (Convert.ToBoolean((Session["RoleName"].ToString()) == "SuperAdmin")){<a class='btn btn-success btn-sm' style='font-size:10px;' onclick=interviewSelect(" + data + ")> InterviewSelected </a><a class='btn btn-danger btn-sm' style='margin-top:5px; font-size:10px;' onclick=interviewReject(" + data + ")> InterviewRejected </a>}";
                                },
                                "orderable": false,
                                "searchable": false,
                                "visible": false,
                                "width": "100px"
                            },*@
                             {
                                "data": "employeeid", "render": function (data) {
                                     return "@if (Convert.ToBoolean((Session["RoleName"].ToString()) == "SuperAdmin")){<span class='d-flex'><a class='btn btn-success btn-sm mx-1' 'style='font-size:10px;' onclick=interviewSelect(" + data + ")>SelectedCandidate</a><a class='btn btn-danger btn-sm'  font-size:10px;' onclick=interviewReject(" + data + ")> RejectCandidate </a></span>}";
                                },
                                "orderable": false,
                                "searchable": false,
                                "visible": true,
                                "width": "100px"
                            }


                        ],
                        "language": {

                            "emptyTable": "No data found!!!"
                        }
                    });
                });


                $(document).ready(function () {
                    $("#checkAll").click(function () {
                        if (this.checked) {
                            $('.checkBoxClass').each(function () {
                                $(".checkBoxClass").prop('checked', true);
                                getCheckedData();
                            })
                        } else {
                            $('.checkBoxClass').each(function () {
                                $(".checkBoxClass").prop('checked', false);
                            })

                            var deleteAll = document.getElementById("deleteAll");


                            deleteAll.remove();
                            //exports.remove();
                        }
                    });
                });

                function getCheckedData() {
                    var exclude = document.getElementById("excBound");

                    var flag = 0;
                    if (exclude.hasChildNodes()) {
                        flag = 1;
                    }
                    else {


                        var exc = document.createElement('button');
                        exc.setAttribute('class', 'btn btn-danger btn-lg');
                        exc.setAttribute('id', 'deleteAll');
                        exc.setAttribute('onclick', 'excluderejectitems()');
                        exc.setAttribute('style', 'margin-left:5px');
                        exc.innerHTML = "Flip to Reject List";
                        excBound.appendChild(exc);





                    }
                }

                function excluderejectitems() {
                    if (confirm('Are You Sure  to move this record to reject resume list ?')) {
                        var array = [];
                        $.each($("input[name='datarows']:checked"), function () {
                            array.push($(this).val());
                        });
                        $.ajax({
                            url: "/home/rejectitems",
                            type: "POST",
                            dataType: "json",
                            data: { esid: array },
                            success: function (data) {
                                if (data.success) {
                                    dataTable.ajax.reload();

                                    $.notify(data.message, {
                                        globalPosition: "top center",
                                        className: "success"
                                    })

                                }
                            }
                        });
                    }

            }

            function interviewSelect(id) {
                if (confirm('Are You Sure to Select this Employee Record ?')) {
                    $.ajax({
                        url: '@Url.Action("InterviewSelect", "Home")/' + id,
                        type: "POST",
                        success: function (data) {
                            if (data.success)
                            {
                                dataTable.ajax.reload();

                                $.notify(data.message, {
                                    globalPosition: "top center",
                                    className: "success"
                                })

                            }
                        }
                    });
                }
            }



         



            function interviewReject(id) {
                debugger;
                if (confirm('Are You Sure to reject this Employee Record ?')) {
                    $.ajax({
                        url: '@Url.Action("InterviewReject", "Home")/' + id,
                        method: "post",
                        success: function (data) {
                            if (data.success)
                            {
                                dataTable.ajax.reload();

                                $.notify(data.message, {
                                    globalPosition: "top center",
                                    className: "success"
                                })

                            }
                        }
                    });
                }
            }


        </script>
    }


















